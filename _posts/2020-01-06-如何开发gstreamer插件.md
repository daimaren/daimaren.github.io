---
layout:     post
title:      如何开发gstreamer插件
subtitle:   
date:       2020-01-06
author:     Glen
header-img: img/post-bg-none.jpg
catalog: true
tags:
    - gstreamer
---

​	Gstreamer上第一方及第三方插件众多，根据许可证的不同，被分作Base、Good、Ugly和Bad等类型。其中Base插件涵盖了一些常用的、种类覆盖全面的、其他插件非常依赖的部分，可以被安全地在任何情况下使用，Good插件通常意味着基于LGPL的、可以较自由地使用的插件，Ugly类型的插件可能使用或依赖不安全或不常用的库，也可能遇到专利授权问题。所有其他类型的插件都被归类于Bad类型，它们更进一步，除依赖、授权和专利问题以外，还不太保证代码质量，例如存在标准缺失或较明显的设计漏洞等，尤其是对于后两类插件，建议详细甄别后再行使用。

​	另外，作为嵌入式设备上流行的多媒体框架，SOC厂商也会独立地提供专门开发的插件（通常是适配了该芯片上的各种硬件）和经过筛选的插件集，这些和官方版本并不一定相同。

​	GStreamer开发插件基本流程如下：

- 1.获取插件模版。
- 2.制定新Element的细节，如名称、作者、版本号等。
- 3.在_class_init（）中注册插件。
- 4.定义Element所需的Pad及其细节、类型或其支持类型的列表。
- 5.写一个plugin_init函数，其在插件加载后立即被调用。
- 6.需要实现gst_my_filter_init和gst_my_filter_chain函数，当插件被使用时，函数会负责实际的数据处理。
- 7.设置并实现所需监听和处理的事件。
- 8.实现插件对Pipeline状态变化的响应（插件总会被加入某个Pipeline中）。
- 9.实现gst_my_filter_src_query函数，让调用者可以得到插件本身的信息。完成上述步骤的开发，即可将插件嵌入GStreamer的框架中一起工作。GStreamer的插件开发，既可以萧规曹随，仿照现有的相似插件编写，也为应用者提供了很大的定制空间，如定制特殊的插件类型、自我管理内存分配和时钟、封装其他软件框架等。